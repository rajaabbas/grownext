# Base Apps Hardening – Portal Plan (v0.2.0)

> Status: 📝 Draft (Oct 2025). Supports the Oct 23 identity hardening sprint by validating portal surfaces against tightened access controls.

## Goals
- Confirm portal flows remain stable with the new identity guardrails and throttling policies.
- Close outstanding UI/UX bugs uncovered during identity integration testing.
- Ensure documentation and smoke coverage stay current ahead of the Oct 24 portal-focused sprint.

## Scope
1. **Identity Integration Verification *(Status: 📝 Draft – Oct 2025)***
   - [x] Exercise login, organization switch, and impersonation flows against the revised identity APIs. _(Automated coverage via updated identity client error handling; manual smoke still required to confirm banners render end-to-end.)_
   - [x] Validate updated headers/token usage in shared SDK calls (`@ma/identity-client`).
   - [x] Capture any compatibility fixes required for Oct 24 portal hardening drops. _(Portal billing invoices now forward organization headers; throttle messaging guards added.)_
2. **UI & Stability Fixes *(Status: 📝 Draft – Oct 2025)***
   - [x] Resolve regression bugs reported during identity guardrail testing (loading states, error messaging). _(Billing plan + contacts editors surface rate-limit guidance.)_
   - [x] Polish empty/error states surfaced by new throttling conditions. _(Tenant context provider now reports throttling friendly copy.)_
   - [ ] Confirm impersonation banners and admin quick actions render correctly after auth changes. _(Manual validation pending.)_
3. **Docs & Automation *(Status: 📝 Draft – Oct 2025)***
   - [x] Update portal ops runbook with guidance for the new smoke pipeline triggers.
   - [x] Align onboarding/support docs with refined access control messaging. _(See `docs/setup/onboarding.md` portal smoke section.)_
   - [ ] Ensure Playwright smoke suite is ready for the Oct 23 pipeline and Oct 24 hardening sprint. _(Manual follow-up: `pnpm --filter @ma/e2e run test:smoke -- --grep portal` once staging refreshed.)_

## Dependencies
- Identity v0.2.0 deployment delivering guardrail and audit updates.
- Admin UI cooperation for shared components touched during impersonation or throttling flows.
- Worker support for impersonation cleanup and token expiry handling.

## Testing & Validation
- [ ] Playwright smoke run covering auth, Launchpad, impersonation, and tenant management. _(Manual – see onboarding doc for command.)_
- [ ] Manual regression checklist for UI bug fixes tied to throttling/guardrails. _(Pending support QA.)_
- [ ] Accessibility spot-check for any UI adjustments introduced during the fixes. _(Manual QA to schedule.)_

## Documentation
 - [x] Refresh portal runbook sections referencing identity throttling and smoke automation.
 - [x] Add release note entry summarizing portal readiness work for Oct 23.
